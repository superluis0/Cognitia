# Cognitia

**Explore Grokipedia topics as you browse X.com** — Cognitia is a Chrome extension that automatically detects and highlights topics from the xAI knowledge base (Grokipedia) in your feed, providing AI-powered summaries, fact-checking, and interactive chat powered by xAI's Grok model.

## Features

### Core Functionality
- **Grokipedia Topic Detection**: Automatically highlights 1,200+ topics from Grokipedia as you scroll through X.com
- **AI-Powered Summaries**: Click highlighted topics to see full Grokipedia context with summaries generated by xAI Grok
- **Fact-Check Tweets**: Shield button on each tweet asks "Grok, is this true?" — fact-checks claims using Grok's live search + Grokipedia data
- **Chat with Topics**: Discuss Grokipedia topics or chat with Grok about general questions
- **Topic History**: Track recently viewed topics, chats, and fact-checks with instant one-click restoration

### Customization
- **7 Highlight Styles**: Dotted, solid, dashed, wavy, tint, combo, and colored overlays
- **Live Preview**: See highlight styles applied to sample topics before saving
- **In-Sidebar Settings**: Change preferences without leaving X.com

### Auto-Updates
- **Auto-Crawling**: Hourly discovery of new topics from Grokipedia links
- **Auto-Refresh**: Extension re-scans tweets every 5 minutes to highlight newly discovered topics
- **Intelligent Seeding**: Database grows from Wikipedia Vital Articles baseline with continuous crawling

### Premium Experience
- **"Neural Elegance" Design**: Glassmorphism UI with Amber Ember color palette
- **Markdown Rendering**: Full support for headers, lists, code blocks, tables, and formatting in summaries and chat
- **Auto-Expanding Chat**: Textarea grows as you type (Shift+Enter for multi-line)
- **Typography**: Clash Display (headers), Space Grotesk (body), JetBrains Mono (code)

## How It Works

### Architecture

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  Chrome         │     │  Node.js        │     │  External APIs  │
│  Extension      │────▶│  Backend        │────▶│  - X API v2     │
│  (Content +     │◀────│  (Express +     │◀────│  - xAI Grok     │
│   Background)   │     │   SQLite)       │     │  - Grokipedia   │
└─────────────────┘     └─────────────────┘     └─────────────────┘
        │                       │
        │                       ▼
        ▼            ┌──────────────────────┐
┌─────────────────┐  │  Grokipedia Crawler  │
│  DOM Overlay    │  │  (Python + Node.js)  │
│  (Highlights,   │  │  - Link discovery    │
│   Tooltips,     │  │  - Parallel crawling │
│   Sidebar,      │  │  - Auto-scheduling   │
│   Fact-Check)   │  └──────────────────────┘
└─────────────────┘           │
                               ▼
                    ┌──────────────────────┐
                    │  SQLite + FTS5       │
                    │  - 1,200+ topics     │
                    │  - Aho-Corasick      │
                    │  - Discovery queue   │
                    └──────────────────────┘
```

### Data Flow

1. **Topic Detection**: Extension detects visible tweets on X.com
2. **Text Extraction**: Backend fetches tweet text via X API v2
3. **Topic Matching**: Aho-Corasick algorithm matches topics against Grokipedia database
4. **Visual Highlighting**: Extension highlights matched topics in the DOM
5. **Summary Generation**: On click, Grok generates contextual summary from Grokipedia
6. **Fact-Checking**: Grok analyzes claims using live web/X search + Grokipedia context
7. **Continuous Learning**: Crawler discovers new topics from Grokipedia links and expands database hourly

## Setup

### Prerequisites

- Node.js 18+
- Python 3.9+
- Chrome browser
- **xAI API key** — Get from [https://console.x.ai/](https://console.x.ai/)
- **X API Bearer Token** — Get from [https://developer.x.com/](https://developer.x.com/)

### Backend Setup

```bash
cd backend
npm install

# Create .env file
cp .env.example .env

# Edit .env with your API keys:
# XAI_API_KEY=your_key_here
# X_API_BEARER_TOKEN=your_token_here

npm run build
npm start
```

Backend runs on `http://localhost:3001`. The crawler scheduler starts automatically, discovering new Grokipedia topics hourly.

### Seed Initial Topics

To bootstrap the database with 1,200+ topics from Wikipedia:

```bash
curl -X POST http://localhost:3001/api/scheduler/seed-parallel
```

Monitor seeding progress:
```bash
curl http://localhost:3001/api/scheduler/parallel-status
```

### Extension Setup

```bash
cd extension
npm install
npm run build
```

1. Open Chrome → `chrome://extensions/`
2. Enable "Developer mode" (top right)
3. Click "Load unpacked"
4. Select the `extension` folder

## Usage

1. Go to [x.com](https://x.com)
2. Scroll your feed — Grokipedia topics appear **highlighted in amber**
3. **Hover** over a topic → Quick summary tooltip
4. **Click** a topic → Sidebar opens with:
   - Full Grokipedia summary
   - Link to full Grokipedia article
   - Quick questions to explore
   - Chat interface for follow-ups
5. **Shield icon** on any tweet → Fact-check the claims with Grok
6. **Home button** (sidebar) → Settings with style options
7. **Chat with Grok** → General AI chat (reasoning mode)
8. **View History** → Browse recently viewed topics, chats, and fact-checks

## API Endpoints

### Topic Matching
- `POST /api/match` — Detect topics in tweet text

### Summaries & Chat
- `POST /api/summary` — Generate Grokipedia-based summary
- `POST /api/chat` — Topic-specific chat with Grok
- `POST /api/chat/general` — General chat (reasoning model)
- `POST /api/questions` — Suggested follow-up questions

### Fact-Checking
- `POST /api/fact-check` — Fact-check tweet claims with Grok + Grokipedia

### Crawler & Scheduler
- `GET /api/scheduler/status` — Current scheduler status
- `POST /api/scheduler/seed-parallel` — Start Wikipedia seeding (1,200+ topics)
- `GET /api/scheduler/parallel-status` — Seeding progress
- `GET /api/scheduler/debug-queue` — Inspect discovery queue
- `POST /api/scheduler/reset-queue` — Clear discovery queue
- `POST /api/scheduler/start` — Enable hourly crawling
- `POST /api/scheduler/stop` — Disable crawling
- `POST /api/scheduler/trigger` — Manually trigger crawl batch

## Tech Stack

### Extension
- TypeScript + Chrome Manifest V3
- Custom markdown renderer
- Glassmorphism animations

### Backend
- Node.js + Express
- TypeScript
- SQLite with FTS5 full-text search
- Aho-Corasick multi-pattern matching

### AI & Data Sources
- **xAI Grok API**: `grok-4-1-fast-non-reasoning-latest` for summaries, `grok-4-1-fast-reasoning-latest` for general chat
- **X API v2**: Tweet text retrieval
- **Grokipedia**: Knowledge source for topics and fact-checking context

### Crawler
- Python 3 crawler for Grokipedia content extraction
- Node.js wrapper with parallel processing (20 workers)
- Automatic link discovery for continuous growth
- Hourly scheduled batches

## Design System

- **Colors**: "Amber Ember" palette (#f59e0b, #d97706, #b45309)
- **Typography**: Clash Display (headers), Space Grotesk (body), JetBrains Mono (code)
- **Effects**: Glassmorphism, staggered reveal animations, gradient borders
- **Styles**: 7 customizable highlight modes (dotted, solid, dashed, wavy, tint, combo, colored)

## License

MIT
